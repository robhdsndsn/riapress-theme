import{getElement as e,store as t}from"@wordpress/interactivity";const n=t("zp/offcanvas-navigation",{state:{isOpen:!1,lastFocusedElement:null,get scrollbarWidth(){return window.innerWidth-document.documentElement.clientWidth}},actions:{openOffcanvas:function(e){e.preventDefault(),a.lastFocusedElement=document.activeElement!==e.target?document.activeElement:null,a.isOpen=!0;const t=document.body,n=a.scrollbarWidth;t.classList.add("offcanvas-is-active"),t.style.overflow="hidden",t.style.paddingRight=`${n}px`,document.documentElement.style.setProperty("--scrollbar-width",`${n}px`);const s=document.getElementById("offcanvas");s&&s.setAttribute("aria-hidden","false"),setTimeout(()=>{const e=s?.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');e&&e.focus()},10),o.addFocusTrap()},closeOffcanvas:function(e){e.preventDefault(),o.removeFocusTrap(),document.activeElement&&document.activeElement.blur&&document.activeElement.blur();const t=document.getElementById("offcanvas-open-toggle"),n=a.lastFocusedElement&&a.lastFocusedElement!==e.target?a.lastFocusedElement:t;n&&(n.focus(),document.activeElement!==n&&setTimeout(()=>{n.focus()},10)),a.isOpen=!1;const s=document.getElementById("offcanvas");s&&s.setAttribute("aria-hidden","true");const c=document.body;c.classList.remove("offcanvas-is-active"),c.style.overflow="",c.style.paddingRight=""},handleOutsideClick:function(e){"offcanvas"===e.target.id&&o.closeOffcanvas(e)},handleEscapeKey:function(e){"Escape"===e.key&&a.isOpen&&o.closeOffcanvas(e)},addFocusTrap:function(){document.addEventListener("keydown",o.trapFocus),document.addEventListener("keydown",o.handleEscapeKey)},removeFocusTrap:function(){document.removeEventListener("keydown",o.trapFocus),document.removeEventListener("keydown",o.handleEscapeKey)},trapFocus:function(e){if("Tab"!==e.key)return;const t=document.getElementById("offcanvas");if(!t||t.classList.contains("hidden"))return;const n=Array.from(t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'));if(0===n.length)return;const a=n[0],o=n[n.length-1];e.shiftKey?document.activeElement===a&&(e.preventDefault(),o.focus()):document.activeElement===o&&(e.preventDefault(),a.focus())},toggleSubmenu:function(t){const{ref:n}=e();t.preventDefault(),t.stopPropagation();const a=n.closest(".wp-block-navigation");!function(e,t){const n=!("true"===e.getAttribute("aria-expanded")),a=e.closest(".wp-block-navigation-submenu"),o=a?.querySelector(".wp-block-navigation__submenu-container");t.querySelectorAll(".wp-block-navigation-submenu").forEach(e=>{if(e!==a){const t=e.querySelector(".wp-block-navigation__submenu-icon"),n=e.querySelector(".wp-block-navigation__submenu-container");t&&n&&(t.setAttribute("aria-expanded","false"),n.style.display="none",e.classList.remove("is-open"))}}),e.setAttribute("aria-expanded",String(n)),o&&a&&(n?(o.style.display="block",a.classList.add("is-open")):(o.style.display="none",a.classList.remove("is-open")))}(n,a)},preventHover:function(e){return e.stopImmediatePropagation(),e.preventDefault(),!1}}}),{state:a,actions:o}=n;document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("offcanvas");e&&function(e){const t=e.querySelector(".wp-block-navigation");t&&!t.hasAttribute("data-rp-enhanced")&&(t.setAttribute("data-rp-enhanced","true"),t.querySelectorAll(".wp-block-navigation-submenu").forEach(e=>{var t;t=e,Array.from(t.attributes).forEach(e=>{(e.name.startsWith("data-wp-on")||e.name.startsWith("data-wp-watch")||e.name.startsWith("data-wp-bind")||"data-wp-interactive"===e.name)&&!e.name.includes("disabled")&&(t.setAttribute(e.name+"-disabled",e.value),t.removeAttribute(e.name))});const n=e.querySelector(".wp-block-navigation__submenu-icon");n&&(n.setAttribute("data-wp-interactive","zp/offcanvas-navigation"),n.setAttribute("data-wp-on-async--click","actions.toggleSubmenu"),n.setAttribute("data-wp-on-async--mouseenter","actions.preventHover"),n.setAttribute("data-wp-on-async--mouseleave","actions.preventHover")),e.classList.add("click-only-submenu"),e.classList.remove("open-on-hover")}))}(e)});