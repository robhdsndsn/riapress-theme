(()=>{"use strict";var e,t={597:(e,t,o)=>{const l=window.wp.blocks,a=window.React,r=window.wp.i18n,s=window.wp.element,n=(window.wp.date,window.wp.blockEditor),i=window.wp.components,d=window.wp.data,c=window.wp.serverSideRender;var p=o.n(c);const m=JSON.parse('{"UU":"zp/post-related"}');(0,l.registerBlockType)(m.UU,{edit:function({attributes:e,setAttributes:t}){const{postType:o,numberOfPosts:l,displayFeaturedImage:c,displayExcerpt:m,displayMeta:u,order:g,orderBy:x,categories:y,headingLevel:h,columns:b,className:f,selectedPosts:P,selectedTaxonomy:v,selectedTaxonomies:_,currentPostTaxonomies:E,variant:C="default",customColor:R,customBackgroundColor:w,customBorderColor:k}=e,[T,S]=(0,s.useState)(""),[B,O]=(0,s.useState)(!1),L=y&&y.length>0?y.map(e=>e.id):[],I=((0,d.useSelect)(e=>e("core").getEntityRecords("postType",o,{per_page:l,_embed:!0,order:g,orderby:x,categories:L}),[o,l,g,x,y]),(0,d.useSelect)(()=>wp.data.select("core").getEntityRecords("taxonomy","category",{per_page:-1}),[])),j=(0,d.useSelect)(e=>!T||T.length<3?[]:e("core").getEntityRecords("postType",o,{search:T,per_page:10,_embed:!0})||[],[T,o]),A=(0,d.useSelect)(e=>P&&0!==P.length?P.map(t=>e("core").getEntityRecord("postType",o,t)).filter(Boolean):[],[P,o]),M=(0,d.useSelect)(e=>e("core/editor").getCurrentPost(),[]),N=(0,d.useSelect)(e=>{const{getCurrentPostId:t,getCurrentPostType:o}=e("core/editor"),{getEditedEntityRecord:l}=e("core"),a=t(),r=l("postType",o(),a),s={};return["clri-projects","clri-site","format","fltca-alignment","page-type","primary-role","topic"].forEach(e=>{const t=r?.[e]||[];s[e]=t}),s},[]);(0,s.useEffect)(()=>{if(0===P.length&&M&&M.meta){const e=M.meta._rp_resource_related_resources;if(e&&Array.isArray(e)&&e.length>0){const o=e.map(e=>parseInt(e,10)).filter(e=>e>0);o.length>0&&t({selectedPosts:o})}}},[M]),(0,s.useEffect)(()=>{P.length>0&&M?wp.data.dispatch("core/editor").editPost({meta:{...M.meta,_rp_resource_related_resources:P}}):0===P.length&&M&&M.meta&&M.meta._rp_resource_related_resources&&wp.data.dispatch("core/editor").editPost({meta:{...M.meta,_rp_resource_related_resources:[]}})},[P]),(0,s.useEffect)(()=>{if(N&&"object"==typeof N){const o=e.currentPostTaxonomies||{};JSON.stringify(o)!==JSON.stringify(N)&&t({currentPostTaxonomies:N})}},[N,t]);const W={};if(I)for(let e=0;e<I.length;e++){const t=I[e];W[t.name]=t}const D=(e,o)=>{const l=P||[];if(o<0||o>=l.length)return;const a=[...l],[r]=a.splice(e,1);a.splice(o,0,r),t({selectedPosts:a})},z=(e,o)=>{const l=_||[];if(o<0||o>=l.length)return;const a=[...l],[r]=a.splice(e,1);a.splice(o,0,r),t({selectedTaxonomies:a})},F=["wp-block-rp-post-related"];return"default"!==C&&F.push(`has-${C}-variant`),"custom"===C&&(R||w||k)&&F.push("has-custom-colors"),(0,a.createElement)("div",{...(0,n.useBlockProps)({className:F.join(" "),style:"custom"===C?{"--custom-color":R||void 0,"--custom-background-color":w||void 0,"--custom-border-color":k||void 0}:{}})},(0,a.createElement)(n.BlockControls,null,(0,a.createElement)(i.ToolbarDropdownMenu,{className:"heading-level-dropdown",label:(0,r._x)("Heading Level","Post Latest - Title","post-related"),icon:(0,a.createElement)(i.Icon,{icon:()=>`H${h}`}),controls:[1,2,3,4,5,6].map(e=>({icon:(0,a.createElement)(i.Icon,{icon:()=>`H${e}`}),isActive:h===e,onClick:()=>{t({headingLevel:e})}}))})),(0,a.createElement)(n.InspectorControls,null,(0,a.createElement)(i.PanelBody,{title:(0,r._x)("Color Settings","Post Related - Title","post-related"),initialOpen:!1},(0,a.createElement)(i.SelectControl,{label:(0,r._x)("Color Variant","Post Related - Label","post-related"),value:C,options:[{label:(0,r._x)("Default","Post Related - Option","post-related"),value:"default"},{label:(0,r._x)("Primary","Post Related - Option","post-related"),value:"primary"},{label:(0,r._x)("Secondary","Post Related - Option","post-related"),value:"secondary"},{label:(0,r._x)("Accent","Post Related - Option","post-related"),value:"accent"},{label:(0,r._x)("Neutral","Post Related - Option","post-related"),value:"neutral"},{label:(0,r._x)("Custom","Post Related - Option","post-related"),value:"custom"}],onChange:e=>t({variant:e})})),"custom"===C&&(0,a.createElement)(n.PanelColorSettings,{title:(0,r._x)("Custom Colors","Post Related - Title","post-related"),colorSettings:[{value:R,onChange:e=>t({customColor:e}),label:(0,r._x)("Text Color","Post Related - Label","post-related")},{value:w,onChange:e=>t({customBackgroundColor:e}),label:(0,r._x)("Background Color","Post Related - Label","post-related")},{value:k,onChange:e=>t({customBorderColor:e}),label:(0,r._x)("Border Color","Post Related - Label","post-related")}]}),(0,a.createElement)(i.PanelBody,{title:(0,r._x)("Post Selection","Post Related - Title","post-related"),initialOpen:!0},(0,a.createElement)("p",null,(0,r._x)("Selected posts will override algorithm selection.","Post Related - Description","post-related")),A&&A.length>0&&(0,a.createElement)("div",{style:{marginBottom:"16px"}},(0,a.createElement)("strong",null,(0,r._x)("Selected Posts:","Post Related - Label","post-related")),A.map((e,o)=>(0,a.createElement)("div",{key:e.id,style:{padding:"12px",border:"1px solid #ddd",borderRadius:"4px",marginTop:"8px",backgroundColor:"white"}},(0,a.createElement)("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"}},(0,a.createElement)("span",{style:{display:"inline-block",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"#666",color:"white",fontSize:"12px",textAlign:"center",lineHeight:"20px",marginRight:"8px",fontWeight:"bold",flexShrink:0}},o+1),(0,a.createElement)("span",{style:{fontSize:"14px",fontWeight:"500",wordBreak:"break-word"}},e.title.rendered)),(0,a.createElement)("div",{style:{display:"flex",gap:"6px"}},(0,a.createElement)(i.Button,{variant:"secondary",isSmall:!0,onClick:()=>D(o,o-1),disabled:0===o,title:(0,r._x)("Move up","Post Related - Button","post-related"),style:{minWidth:"32px"}},"↑"),(0,a.createElement)(i.Button,{variant:"secondary",isSmall:!0,onClick:()=>D(o,o+1),disabled:o===A.length-1,title:(0,r._x)("Move down","Post Related - Button","post-related"),style:{minWidth:"32px"}},"↓"),(0,a.createElement)(i.Button,{variant:"secondary",isSmall:!0,onClick:()=>{return o=e.id,void t({selectedPosts:(P||[]).filter(e=>e!==o)});var o},title:(0,r._x)("Remove","Post Related - Button","post-related"),style:{minWidth:"65px"}},(0,r._x)("Remove","Post Related - Button","post-related")))))),(0,a.createElement)(i.TextControl,{label:(0,r._x)("Search Posts","Post Related - Label","post-related"),value:T,onChange:S,placeholder:(0,r._x)("Type to search posts...","Post Related - Placeholder","post-related"),help:(0,r._x)("Type at least 3 characters to search","Post Related - Help","post-related")}),T.length>=3&&(0,a.createElement)("div",{style:{marginTop:"12px"}},j.length>0?(0,a.createElement)("div",null,(0,a.createElement)("strong",null,(0,r._x)("Search Results:","Post Related - Label","post-related")),j.map(e=>(0,a.createElement)("div",{key:e.id,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px",border:"1px solid #f0f0f0",borderRadius:"4px",marginTop:"4px"}},(0,a.createElement)("span",null,e.title.rendered),(0,a.createElement)(i.Button,{variant:"primary",isSmall:!0,onClick:()=>(e=>{const o=P||[];o.includes(e)||t({selectedPosts:[...o,e]}),S("")})(e.id),disabled:P?.includes(e.id)},P?.includes(e.id)?(0,r._x)("Added","Post Related - Button","post-related"):(0,r._x)("Add","Post Related - Button","post-related"))))):(0,a.createElement)("p",null,(0,r._x)("No posts found","Post Related - Message","post-related")))),(0,a.createElement)(i.PanelBody,{title:(0,r._x)("Taxonomy Priority","Post Related - Title","post-related"),initialOpen:!1},(0,a.createElement)("p",null,(0,r._x)("Use ↑↓ buttons to reorder. First taxonomy will be checked first by the algorithm.","Post Related - Description","post-related")),_&&_.length>0&&(0,a.createElement)("div",{style:{marginBottom:"16px"}},_.map((e,t)=>{return(0,a.createElement)("div",{key:e,style:{padding:"12px",border:"1px solid #ddd",borderRadius:"4px",marginTop:"8px",backgroundColor:"white"}},(0,a.createElement)("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"}},(0,a.createElement)("span",{style:{display:"inline-block",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"#666",color:"white",fontSize:"12px",textAlign:"center",lineHeight:"20px",marginRight:"8px",fontWeight:"bold",flexShrink:0}},t+1),(0,a.createElement)("span",{style:{fontSize:"14px",fontWeight:"500",wordBreak:"break-word"}},{"clri-projects":"CLRI Projects","clri-site":"CLRI Sites",format:"Formats","fltca-alignment":"FLTCA Alignment","page-type":"Page Types","primary-role":"Primary Roles",topic:"Topics"}[o=e]||o)),(0,a.createElement)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px"}},(0,a.createElement)(i.Button,{variant:"secondary",isSmall:!0,onClick:()=>z(t,t-1),disabled:0===t,title:(0,r._x)("Move up","Post Related - Button","post-related"),style:{minWidth:"32px"}},"↑"),(0,a.createElement)(i.Button,{variant:"secondary",isSmall:!0,onClick:()=>z(t,t+1),disabled:t===_.length-1,title:(0,r._x)("Move down","Post Related - Button","post-related"),style:{minWidth:"32px"}},"↓")));var o}))),(0,a.createElement)(i.PanelBody,{title:(0,r._x)("Display Settings","Post Latest - Title","post-related")},(0,a.createElement)(i.ToggleControl,{label:(0,r._x)("Display Featured Image","Post Latest - Label","post-related"),checked:c,onChange:e=>{t({displayFeaturedImage:e})}}),(0,a.createElement)(i.ToggleControl,{label:(0,r._x)("Display Meta","Post Latest - Label","post-related"),checked:u,onChange:e=>{t({displayMeta:e})}}),(0,a.createElement)(i.ToggleControl,{label:(0,r._x)("Display Excerpt","Post Latest - Label","post-related"),checked:m,onChange:e=>{t({displayExcerpt:e})}})),(0,a.createElement)(i.PanelBody,{title:(0,r._x)("Query Settings","Post Related - Title","post-related")},(0,a.createElement)(i.QueryControls,{numberOfItems:l,onNumberOfItemsChange:e=>{t({numberOfPosts:e})},maxItems:10,minItems:1})),(0,a.createElement)(i.PanelBody,{title:(0,r._x)("Layout Settings","Latest- Ti  Postsle","post-related")},(0,a.createElement)(i.RangeControl,{label:(0,r._x)("Columns","Post Latest - Label","post-related"),min:1,max:3,onChange:e=>{t({columns:e})},value:b}))),(0,a.createElement)(p(),{block:"zp/post-related",attributes:{...e,currentPostTaxonomies:E||{}},key:JSON.stringify(E)}))},save:function(){return null}})}},o={};function l(e){var a=o[e];if(void 0!==a)return a.exports;var r=o[e]={exports:{}};return t[e](r,r.exports,l),r.exports}l.m=t,e=[],l.O=(t,o,a,r)=>{if(!o){var s=1/0;for(c=0;c<e.length;c++){for(var[o,a,r]=e[c],n=!0,i=0;i<o.length;i++)(!1&r||s>=r)&&Object.keys(l.O).every(e=>l.O[e](o[i]))?o.splice(i--,1):(n=!1,r<s&&(s=r));if(n){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[o,a,r]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};l.O.j=t=>0===e[t];var t=(t,o)=>{var a,r,[s,n,i]=o,d=0;if(s.some(t=>0!==e[t])){for(a in n)l.o(n,a)&&(l.m[a]=n[a]);if(i)var c=i(l)}for(t&&t(o);d<s.length;d++)r=s[d],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(c)},o=globalThis.webpackChunkrp_post_related=globalThis.webpackChunkrp_post_related||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var a=l.O(void 0,[350],()=>l(597));a=l.O(a)})();